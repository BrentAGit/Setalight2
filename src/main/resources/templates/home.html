<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="icon" href="/img/icon.png" type="image/gif" sizes="16x16">
    <meta charset="UTF-8">
    <title th:value="${application}">Setalight</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/bootstrap.min.css}" href="/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" href="/css/style.css">
    <script th:inline="javascript" type="text/javascript" th:src="@{/js/Calender-script.js}" src="/js/Calender-script.js"></script>
    <!--    add here personal CSS-->
</head>
<body>
<div th:replace="fragments/header">Header</div>
<br>
<div class="small-calender">
    <div id="header" class="clearfix">
        <a href="/calender">calender</a>
        <div class="pre-button"><</div>
        <div class="head-info" id="head-info">
            <div class="head-day"></div>
            <div class="head-month"></div>
        </div>
        <div class="next-button">></div>
    </div>
    <table id="calendar">
        <thead>
        <tr>
            <th>Ma</th>
            <th>Di</th>
            <th>Wo</th>
            <th>Do</th>
            <th>vr</th>
            <th>za</th>
            <th>zo</th>
        </tr>
        </thead>
        <tbody id="body">
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
        </tbody>
    </table>
</div>
<div class="container">
    <div class="row">
        <div class="col-2 filterButtons">
            <ul>
                <li th:each="filter : ${filterButtons}">
                    <a th:text="${filter}" th:href="'/filter/' + ${filter}" href="/filter"></a>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="container event-cards">
    <div class="card-columns">
        <div th:each="event : ${events}" class="card p-2">
            <h3 th:text="${event.getName()}">eventName</h3>
            <p th:text="${event.getDescription()}">description</p>
            <p th:text="${event.getDateString()}">datum</p>
            <p th:text="'begin tijd ' + ${event.getStartTime()}">startTate</p>
            <p th:text="'eind tijd ' + ${event.getEndTime()}">endTime</p>
            <div class="card-footer">
                <a th:href="'/event/events/' + ${event.getId()}" class="btn btn-danger" href="/">going?</a>
            </div>
        </div>
    </div>
</div>
<script th:inline="javascript">
    /*<![CDATA[*/
    let events = /*[[${events}]]*/ 'default'
    /*]]>*/
    document.addEventListener('DOMContentLoaded', function () {
        let header = document.getElementById("head-info");
        let body = document.getElementById("body");
        let pre = document.getElementsByClassName("pre-button");
        let next = document.getElementsByClassName("next-button");
        pre[0].addEventListener("click", () => {
            updateEvents(events, header, body)
        });
        next[0].addEventListener("click", () => {
            updateEvents(events, header, body)
        });
        updateEvents(events, header, body);
    });

    const updateEvents = function (events, header, body) {
        let monthYear = header.children[1].innerHTML;
        let monthU = monthYear.split("-")[0].replace(/\s+/g, '');
        let yearU = monthYear.split("-")[1].replace(/\s+/g, '');
        let today = header.children[0];
        switch (monthU) {
            case "Jan":
                monthU = "01";
                break;
            case "Feb":
                monthU = "02";
                break;
            case "Maa":
                monthU = "03";
                break;
            case "Apr":
                monthU = "04";
                break;
            case "Mei":
                monthU = "05";
                break;
            case "Jun":
                monthU = "06";
                break;
            case "Jul":
                monthU = "07";
                break;
            case "Aug":
                monthU = "08";
                break;
            case "Sep":
                monthU = "09";
                break;
            case "Okt":
                monthU = "10";
                break;
            case "Nov":
                monthU = "11";
                break;
            case "Dec":
                monthU = "12";
                break;
        }
        for (let children of body.children) {
            for (let child of children.children) {
                if (child.innerHTML.length !== 0) {
                    let childDate = yearU + "-" + monthU + "-" + child.innerHTML;
                    for (let event of events) {
                        let eventDate = event.date.split("T")[0];
                        if (eventDate === childDate) {
                            child.className = "eventDay"
                            child.addEventListener("click", () => {
                                location.assign("/event/events/" + event.id);
                            })
                        }
                    }
                }
            }
        }
    }
</script>
</body>
</html>